(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{245:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"常见问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),a("p",[t._v("本章总结收到的用户反馈问题，集中展示，方便后续用户自助解决问题")]),t._v(" "),a("h2",{attrs:{id:"代码下载慢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码下载慢"}},[t._v("#")]),t._v(" 代码下载慢")]),t._v(" "),a("p",[t._v("建议使用 "),a("a",{attrs:{href:"http://www.freedownloadmanager.org/download.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("Free Download Manager"),a("OutboundLink")],1),t._v(" 下载，速度会有显著提升")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://qiniucdn.fairyever.com/20180722210734.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"无法启动项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#无法启动项目"}},[t._v("#")]),t._v(" 无法启动项目")]),t._v(" "),a("p",[t._v("如果在 "),a("code",[t._v("run dev")]),t._v(" 或者 "),a("code",[t._v("npm i")]),t._v(" 的过程中报错，首先建议您升级 node 版本 > 8，在以下环境测试可用")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("➜  ~ npm -v\n5.6.0\n➜  ~ node -v\nv8.11.1\n➜  ~ nrm -V\n1.0.2\n➜  ~ nrm ls\n  npm ---- https://registry.npmjs.org/\n  cnpm --- http://r.cnpmjs.org/\n* taobao - https://registry.npm.taobao.org/\n  nj ----- https://registry.nodejitsu.com/\n  rednpm - http://registry.mirror.cqupt.edu.cn/\n  npmMirror  https://skimdb.npmjs.com/registry/\n  edunpm - http://registry.enpmjs.org/\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("推荐使用 "),a("a",{attrs:{href:"https://github.com/Pana/nrm",target:"_blank",rel:"noopener noreferrer"}},[t._v("nrm"),a("OutboundLink")],1),t._v(" 管理 npm 源，不建议使用 cnpm")])]),t._v(" "),a("h2",{attrs:{id:"没有自动打开浏览器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#没有自动打开浏览器"}},[t._v("#")]),t._v(" 没有自动打开浏览器")]),t._v(" "),a("p",[t._v("如果您运行")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run serve\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run start\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run dev\n")])])]),a("p",[t._v("其中任何一个，编译完成后没有自动打开浏览器，请尝试在本机安装 "),a("a",{attrs:{href:"https://cli.vuejs.org/zh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-cli3"),a("OutboundLink")],1),t._v(" 后重新启动项目。")]),t._v(" "),a("h2",{attrs:{id:"热更新失效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#热更新失效"}},[t._v("#")]),t._v(" 热更新失效")]),t._v(" "),a("p",[t._v("如果使用了 cnpm，cnpm 使用 symlink，导致 webpack 打包的时候抒符号链接的包打包了两份，由于webpack/hot/emitter.js 为两个不同实例，导致 webpack hot/server webpackHotUpdate 无法触发，热更新失效。解决方法：设置 registry，不使用 cnpm。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" registry https://registry.npm.taobao.org\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])]),a("p",[t._v("如果上面的方法无效，尝试在 "),a("code",[t._v("vue.config.js")]),t._v(" 中如下设置：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("chainWebpack")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("config")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resolve\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("symlinks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" config\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("如果不清楚怎么写可以参考新版 D2Admin 的配置。")]),t._v(" "),a("blockquote",[a("p",[t._v("There is a resolve.symlinks in webpack configuration, and it's default value is true. Howerver, project created by vue-cli, the resolve.symlinks is set to false.")])]),t._v(" "),a("p",[t._v("其它解决办法请参考 "),a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/issues/1559",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-cli/issues/1559"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"node-sass-安装失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-sass-安装失败"}},[t._v("#")]),t._v(" node-sass 安装失败")]),t._v(" "),a("p",[t._v("由于某些不可描述的原因，利用 npm 进行安装模块的时候会发生包下载失败的情况，node-sass 尤其的频繁，或者说 node-sass 的二进制文件是接近百分百失败的，即使用 yarn 安装也依旧在这个点失败，给出以下建议")]),t._v(" "),a("p",[a("strong",[t._v("方法1")])]),t._v(" "),a("p",[t._v("首先，需要提前下载 node-sass 的二进制文件，这个文件可以去 cnpm 仓库下载或者 node-sass 的 github 上去下载，在下载之前我们需要先查看电脑的系统的版本，来确定适合哪个版本的二进制文件，查看版本的指令如下：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("node -p \"[process.platform, process.arch, process.versions.modules].join('-')\"\n")])])]),a("p",[t._v("输入这个指令后会弹出一个系统版本，然后在下面两个地址中选择一个去下载对应系统版本的后缀为 .node 的 node-sass 文件")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://npm.taobao.org/mirrors/node-sass/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cnpm https://npm.taobao.org/mirrors/node-sass/"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/sass/node-sass/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("github https://github.com/sass/node-sass/releases"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("下载完保存到任意位置，最好放置到 package.json 所在位置。然后我们需要手动指定 node-sass 二进制文件的下载源为下载的那个文件，以下是npm与yanr的指令：")]),t._v(" "),a("p",[t._v("npm")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm config set sass-binary-path 你存放刚才下载的二进制文件的目录\n// 例如 npm config set sass-binary-path e:/web/win32-x64-48_binding.node\n")])])]),a("p",[t._v("yarn")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yarn config set sass-binary-path 你存放刚才下载的二进制文件的目录\n// 例如 yarn config set sass-binary-path e:/web/win32-x64-48_binding.node\n")])])]),a("p",[t._v("然后我们即可用正常指令下载了")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("此方法会绑定为本地文件，即无法更新 node-sass 了。如果不希望这样，请使用第二种方法")])]),t._v(" "),a("p",[a("strong",[t._v("方法2")])]),t._v(" "),a("p",[t._v("此方案将把下载源指定为cnpm仓库，更建议使用这种方法")]),t._v(" "),a("p",[t._v("全部的下载源指向cnpm的指令")]),t._v(" "),a("p",[t._v("npm")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm config set registry http://registry.npm.taobao.org\n")])])]),a("p",[t._v("yarn")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yarn config set registry http://registry.npm.taobao.org\n")])])]),a("p",[t._v("只指定node-sass的下载源（建议使用）")]),t._v(" "),a("p",[t._v("npm")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm config set sass-binary-site http://npm.taobao.org/mirrors/node-sass\n")])])]),a("p",[t._v("yarn")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yarn config set sass-binary-site http://npm.taobao.org/mirrors/node-sass\n")])])]),a("h2",{attrs:{id:"关闭-eslint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭-eslint"}},[t._v("#")]),t._v(" 关闭 ESLint")]),t._v(" "),a("p",[t._v("由于使用者技术水平参差不齐，有些朋友希望在开发时关闭 ESLint，虽然我不建议这样做，在这里也给出以下方法，或者你也可以在下面的链接里找到答案")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://eslint.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ESLint 中文"),a("OutboundLink")],1),t._v(" | "),a("a",{attrs:{href:"https://eslint.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ESLint 英文"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("方法 1")])]),t._v(" "),a("p",[t._v("在根目录的 "),a("code",[t._v(".eslintignore")]),t._v(" 中添加 "),a("code",[t._v("*.vue")]),t._v("，就会忽略所有 vue 文件后缀的检查，js 文件同理。修改后重启本地服务。")]),t._v(" "),a("ul",[a("li",[t._v("方法 2")])]),t._v(" "),a("p",[t._v("在根目录中的 "),a("code",[t._v(".eslintrc.js")]),t._v(" 找到 "),a("code",[t._v("'@vue/standard'")]),t._v(" 并注释掉，修改后重启本地服务。")]),t._v(" "),a("h2",{attrs:{id:"修改-eslint-规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-eslint-规则"}},[t._v("#")]),t._v(" 修改 ESLint 规则")]),t._v(" "),a("p",[t._v("在根目录中的 "),a("code",[t._v(".eslintrc.js")]),t._v(" 配置规则")]),t._v(" "),a("p",[a("strong",[t._v("语法")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("rules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"规则名"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("规则值"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 规则配置"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("规则值")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"off"')]),t._v(" 或者 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//关闭规则关闭")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"warn"')]),t._v(" 或者 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在打开的规则作为警告（不影响退出代码）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),t._v(" 或者 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//把规则作为一个错误（退出代码触发时为1）")]),t._v("\n")])])]),a("ul",[a("li",[a("a",{attrs:{href:"http://eslint.cn/docs/rules/",target:"_blank",rel:"noopener noreferrer"}},[t._v("规则列表 中文"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://eslint.org/docs/rules/",target:"_blank",rel:"noopener noreferrer"}},[t._v("规则列表 英文"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"侧边栏等部分无法点击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#侧边栏等部分无法点击"}},[t._v("#")]),t._v(" 侧边栏等部分无法点击")]),t._v(" "),a("p",[t._v("如果您打开了 Chrome 的开发者工具并且模拟了非 PC 设备（或者您真的是在 ipad 上访问的项目），在 "),a("a",{attrs:{href:"https://github.com/d2-projects/d2-admin/releases/tag/1.6.11",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.11"),a("OutboundLink")],1),t._v(" 版本之前，侧边栏和优化滚动模式的 "),a("code",[t._v("d2-container")]),t._v(" 组件将会无法点击。请按照 "),a("a",{attrs:{href:"https://github.com/d2-projects/d2-admin/commit/0c8d38d7b690ee6221d491ef0aea0f943f3cb131",target:"_blank",rel:"noopener noreferrer"}},[t._v("0c8d38d"),a("OutboundLink")],1),t._v(" 修改您的代码。")]),t._v(" "),a("blockquote",[a("p",[t._v("造成这个问题的原因是 better-scroll 插件会默认禁止 click 事件。"),a("br"),t._v("\n参见 "),a("a",{attrs:{href:"https://ustbhuangyi.github.io/better-scroll/doc/zh-hans/options.html#click",target:"_blank",rel:"noopener noreferrer"}},[t._v("《better-scroll 文档 | options.click》"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"无法跳转路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#无法跳转路由"}},[t._v("#")]),t._v(" 无法跳转路由")]),t._v(" "),a("p",[t._v("有可能你在 D2Admin 的基础上进行你的开发时，发现在登录页面进行")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("跳转的时候页面并没有跳转，这是因为你很有可能没有进行下面的操作：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'token'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("原因根源是在 "),a("code",[t._v("src/router/index.js")]),t._v(" 中有如下一段代码，根据 "),a("code",[t._v("token")]),t._v(" 判断用户是否登录")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforeEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("matched"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("some")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("meta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'token'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'login'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("所以如果你没有存 token 字段在 cookie 中，路由鉴权机制将会重定向到登录页")]),t._v(" "),a("p",[t._v("如果你想修改基于 token 验证用户登录状态的机制，请在 "),a("code",[t._v("./src")]),t._v(" 下搜索 "),a("code",[t._v("token")]),t._v(" 关键字并修改他们，但是我"),a("strong",[t._v("十分不建议你修改它们")])]),t._v(" "),a("p",[t._v("最好的做法是在登录后返回本次登录的 token 并且存储在 cookie 中，然后在每次 ajax 请求时都携带这个 token 给后端做权限验证（必要的话你可以还可以增加 token 的更新机制）")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("同样需要注意的地方")]),t._v(" "),a("p",[t._v("除了需要在 cookie 中保存 token，你还要保存 uuid 字段，意为“用户唯一标识”")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'uuid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uuid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("D2Admin 会在很多地方使用 cookie 中的此字段区分用户，比如不同用户选择的不同主题的数据持久化，还有不同用户打开的多标签页数据的持久化存储。")])]),t._v(" "),a("h2",{attrs:{id:"异步请求无法携带-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异步请求无法携带-cookie"}},[t._v("#")]),t._v(" 异步请求无法携带 cookie")]),t._v(" "),a("p",[t._v("请先确认您已经给 axios 设置了 "),a("code",[t._v("axios.defaults.withCredentials = true")]),t._v("：")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("一般您应该在 src/plugin/axios/index.js 文件中设置 axios。")])]),t._v(" "),a("p",[t._v("较新的 D2Admin：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  baseURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VUE_APP_API")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  timeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求超时时间")]),t._v("\n  withCredentials"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("或者在较老的 D2Admin 版本 axios 配置文件中添加高亮部分：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),t._v("\n\naxios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("withCredentials "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\naxios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$axios "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("通常这样您已经可以在发送异步请求的时候携带 cookie，但是在 D2 中很可能不行，您还需要禁用掉 mock.js，通常在 main.js 中，请注释掉相关引用代码，并保证 mock.js 没有在项目中其它任何地方被引用。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("为什么这样做")]),t._v(" "),a("p",[t._v("只要调用过 mock.js 的 mock 方法，他就会劫持 window 的 XMLHttpRequest 对象，用一个自己的 XHR 替换，那里面withCredentials 是 false 的，所以无法携带 cookie。")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("补充")]),t._v(" "),a("p",[t._v("此问题在 "),a("a",{attrs:{href:"https://github.com/d2-projects/d2-admin/releases/tag/1.5.3",target:"_blank",rel:"noopener noreferrer"}},[t._v("版本 1.5.3"),a("OutboundLink")],1),t._v(" 已经提供解决方案。")])]),t._v(" "),a("h2",{attrs:{id:"删除页面右上角-github-链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除页面右上角-github-链接"}},[t._v("#")]),t._v(" 删除页面右上角 github 链接")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("src/components/demo/d2-demo-page-cover/index.vue")]),t._v(" 中删除相关代码即可")]),t._v(" "),a("h2",{attrs:{id:"兼容性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#兼容性"}},[t._v("#")]),t._v(" 兼容性")]),t._v(" "),a("p",[t._v("首先 vue.js 和 ElementUI 做不到兼容的，D2Admin 肯定也兼容不了，实测在 macOS 下 Chrome 和新版本的火狐浏览器以及 Safari 都正常使用，这类管理系统一般是内部使用，通常不必太纠结兼容低版本浏览器，如果你发现了显示的 bug，可以加 QQ 群反馈，如果你可以修复这个 bug 使其在你的浏览器上显示正常，欢迎你的 pr。")]),t._v(" "),a("h2",{attrs:{id:"项目里有未完成的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目里有未完成的代码"}},[t._v("#")]),t._v(" 项目里有未完成的代码")]),t._v(" "),a("p",[t._v("有些示例（比如 v-charts 和 ElementUI）是很方便就可以找到官网示例和文档的，这些插件和组件的示例在本项目中就可能处于未完成的状态，但是以后会完成")]),t._v(" "),a("h2",{attrs:{id:"unexpected-end-of-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unexpected-end-of-file"}},[t._v("#")]),t._v(" unexpected end of file")]),t._v(" "),a("p",[t._v("报错代码")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("E:\\VS\\TFS_FREE_Z\\BaseProjects\\VUE\\d2-admin-z>npm i\nnpm WARN tar zlib error: unexpected end of file\nnpm ERR! cb() never called!\nnpm ERR! This is an error with npm itself. Please report this error at:\nnpm ERR!     <https://github.com/npm/npm/issues>\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     C:\\Users\\ZHZ\\AppData\\Roaming\\npm-cache\\_logs\\2018-07-27T13_13_56_693Z-debug.log\n")])])]),a("p",[t._v("解决方法")]),t._v(" "),a("p",[t._v("目前只有一位朋友遇到这个问题，最后使用 cnpm 绕过了这个错误")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm install -g cnpm --registry=https://registry.npm.taobao.org\n")])])]),a("h2",{attrs:{id:"打包后-css-文件位置出错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打包后-css-文件位置出错"}},[t._v("#")]),t._v(" 打包后 CSS 文件位置出错")]),t._v(" "),a("p",[t._v("如果您发现打包后 CSS 文件出现在 dist 文件夹目录内，请检查 "),a("code",[t._v("d2-admin/vue.config.js")]),t._v(" 中 "),a("code",[t._v("baseUrl")]),t._v(" 的设置。")]),t._v(" "),a("p",[a("code",[t._v("baseUrl")]),t._v(" 为项目部署的基础路径，应该以 '/' 开始并且以 '/' 结束")]),t._v(" "),a("p",[t._v("假设你的应用将会部署在域名的根部，比如 https://www.my-app.com/，那么 "),a("code",[t._v("baseUrl")]),t._v(" 应该值为 '/'")]),t._v(" "),a("p",[t._v("如果你的应用时部署在一个子路径下，那么你需要在这里指定子路径。比如，如果你的应用部署在 https://www.foobar.com/my-app/，那么将这个值改为 "),a("code",[t._v("/my-app/")])]),t._v(" "),a("h2",{attrs:{id:"打包后无法运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打包后无法运行"}},[t._v("#")]),t._v(" 打包后无法运行")]),t._v(" "),a("p",[t._v("打包后会生成 dist 文件夹，"),a("strong",[t._v("请在本地开启一个 http 服务来运行打包后的项目")]),t._v("。")]),t._v(" "),a("p",[t._v("如果您不清楚如何操作，建议您使用 "),a("a",{attrs:{href:"http://www.browsersync.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("browsersync"),a("OutboundLink")],1),t._v(" 快速达到目的。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://qiniucdn.fairyever.com/20180821144014.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"灰度模式下弹出框被遮住"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#灰度模式下弹出框被遮住"}},[t._v("#")]),t._v(" 灰度模式下弹出框被遮住")]),t._v(" "),a("p",[t._v("如果您发现 "),a("a",{attrs:{href:"http://element.eleme.io/#/zh-CN/component/dialog",target:"_blank",rel:"noopener noreferrer"}},[t._v("dialog"),a("OutboundLink")],1),t._v(" 在 D2Admin 灰度模式打开情况下被遮罩遮住，可以尝试在弹出框上添加 "),a("code",[t._v(':append-to-body="true"')]),t._v("，将 Dialog 自身是插入至 body 元素上。")]),t._v(" "),a("h2",{attrs:{id:"如何更新版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何更新版本"}},[t._v("#")]),t._v(" 如何更新版本")]),t._v(" "),a("p",[t._v("首先明确告诉大家，此项目无法通过 npm 升级，亦无法通过 cli 升级。")]),t._v(" "),a("p",[t._v("D2Admin 不是一个独立的库，不能像其它插件一样通过 npm 升级版本，不仅这个项目，其实所有的 vue 管理系统脚手架都一样，由于本质上这类项目是一个初始模板，开发者需要做的是下载这些代码，并且根据自身需要去修改它们，然后基于此再去添加自己的业务代码，遂一旦您将代码下载到本地并且发生了修改，您是很难再跟随我们升级的。")]),t._v(" "),a("p",[t._v("iview-admin 作者在一次线下活动中也回答了现场观众的类似问题：")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("“这类项目一旦下载开始使用，基本是无法更新的。你在哪个时间点开始使用，这个项目就固定在什么版本了。”")])])]),t._v(" "),a("p",[t._v("那么可能您 follow 了我，或者 watch 了这个项目，看到我们经常更新代码，发布新的版本，也希望跟随一起更新，那怎么办呢？真的没有办法吗？")]),t._v(" "),a("p",[t._v("有以下两种可行方案：")]),t._v(" "),a("ol",[a("li",[t._v("请您在基于 D2Admin 开发时尽量避免太多的自带模块或者组件改动，这样您可以在发现新版本时下载新的脚手架，并且较方便地将您的业务代码逐步迁移过去。这个方案比较繁琐，所以不建议经常使用，一个月或者几个月一次即可。")]),t._v(" "),a("li",[t._v("我们会尽量在发版时标明每个改动的提交记录，这样您可以选择性地更新部分新代码到您的项目中。同样在开发时尽量避免太多的自带模块或者组件改动，这样您可以直接将新的某个文件替换到您的项目中。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);