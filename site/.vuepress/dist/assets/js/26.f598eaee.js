(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{313:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"多页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多页面"}},[t._v("#")]),t._v(" 多页面")]),t._v(" "),s("p",[t._v("D2Admin 默认支持多页面，并且支持多页面控制器上的 tab 标签页右键菜单控制，可以实现“关闭全部”，“关闭其它”，“关闭左侧”，“关闭右侧”的功能。")]),t._v(" "),s("h2",{attrs:{id:"注册页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册页面"}},[t._v("#")]),t._v(" 注册页面")]),t._v(" "),s("p",[t._v("D2Admin 的多页面设置源头在 "),s("code",[t._v("d2-admin/src/router/routes.js")]),t._v("，该文件导出了一个 "),s("code",[t._v("frameInRoutes")]),t._v(" 变量，"),s("code",[t._v("d2-admin/src/main.js")]),t._v(" 中使用下面的方式导入：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" frameInRoutes "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/router/routes'")]),t._v("\n")])])]),s("p",[t._v("然后在根实例中加入了一个名为 "),s("code",[t._v("getAllPageFromRoutes")]),t._v(" 的方法，该方法在 "),s("code",[t._v("created")]),t._v(" 生命周期调用，递归处理 "),s("code",[t._v("frameInRoutes")]),t._v(" 中的数据将支持多标签页显示所有页面数据扁平为一位数组，然后使用：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("$store"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("commit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'d2admin/page/poolSet'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("将得到的路由数据存储到 vuex 中备用。这份数据在操作多页面数据时会使用到。")]),t._v(" "),s("h2",{attrs:{id:"触发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#触发"}},[t._v("#")]),t._v(" 触发")]),t._v(" "),s("p",[t._v("新建页面的触发在 "),s("code",[t._v("d2-admin/src/router/index.js")]),t._v(" 中的 "),s("code",[t._v("router.afterEach")]),t._v(" 钩子中。涉及的方法参见 "),s("router-link",{attrs:{to:"/zh/sys-vuex/page.html"}},[t._v("API")])],1),t._v(" "),s("h2",{attrs:{id:"标签页控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#标签页控制"}},[t._v("#")]),t._v(" 标签页控制")]),t._v(" "),s("p",[t._v("标签页组件在 "),s("code",[t._v("d2-admin/src/layout/header-aside/components/tabs/index.vue")]),t._v("，该组件实现多页面的各种关闭控制。涉及的方法参见 "),s("router-link",{attrs:{to:"/zh/sys-vuex/page.html"}},[t._v("API")])],1),t._v(" "),s("h2",{attrs:{id:"页面缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面缓存"}},[t._v("#")]),t._v(" 页面缓存")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://fairyever.com/d2-admin/preview/#/demo/playground/page-cache/on",target:"_blank",rel:"noopener noreferrer"}},[t._v("页面打开缓存的效果"),s("OutboundLink")],1),t._v(" | "),s("a",{attrs:{href:"https://fairyever.com/d2-admin/preview/#/demo/playground/page-cache/off",target:"_blank",rel:"noopener noreferrer"}},[t._v("页面关闭缓存的效果"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("要实现页面缓存需要同时满足以下两个条件：")]),t._v(" "),s("ol",[s("li",[t._v("页面组件需要有 name 属性并且 name 属性的值要与当前页面在路由信息中的 name 字段一致。")]),t._v(" "),s("li",[t._v("页面路由设置中要指定 "),s("code",[t._v("meta: { cache: true }")])])]),t._v(" "),s("p",[t._v("下面是两段示例代码，请注意高亮行。")]),t._v(" "),s("p",[t._v("页面组件：")]),t._v(" "),s("div",{staticClass:"language-vue extra-class"},[s("div",{staticClass:"highlight-lines"},[s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-vue"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("d2-container")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    我会被缓存\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("d2-container")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo-page'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("该页面组件在路由中的数据：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("div",{staticClass:"highlight-lines"},[s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/foo/page'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo-page'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  meta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这是一个会被缓存的页面'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    cache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'page/foo/page.vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);